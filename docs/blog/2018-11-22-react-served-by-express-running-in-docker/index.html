<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.10.1"><!-- web fonts --><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><!-- 
    We want to load the font as soon as possible, but not block
    preload will preload but not read the stylesheet
--><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;600&family=Fira+Code:wght@400;500;600&display=swap"><!-- Fallback 1: will read the stylesheet conditionally --><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;600&family=Fira+Code:wght@400;500;600&display=swap" media="print" onload="this.media='all'"><!-- 
    Fallback 2: for JS disabled browsers
    Will be ignored when JS is enabled
 --><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;600&family=Fira+Code:wght@400;500;600&display=swap"></noscript><!-- Primary Meta Tags --><title>React App Served by Express in Docker</title><meta name="title" content="React App Served by Express in Docker"><meta name="description" content="Running in Docker requires special considerations in the front-end. It should dynamically retrieve the backend end-point. For multiple environments, the same docker image could be used while moving from TST to ACC for example."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://giwan.github.io/blog/2018-11-22-react-served-by-express-running-in-docker/"><meta property="og:title" content="React App Served by Express in Docker"><meta property="og:description" content="Running in Docker requires special considerations in the front-end. It should dynamically retrieve the backend end-point. For multiple environments, the same docker image could be used while moving from TST to ACC for example."><meta property="og:image" content="https://giwan.github.io/blog/2018-11-22-react-served-by-express-running-in-docker//placeholder-social.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://giwan.github.io/blog/2018-11-22-react-served-by-express-running-in-docker/"><meta property="twitter:title" content="React App Served by Express in Docker"><meta property="twitter:description" content="Running in Docker requires special considerations in the front-end. It should dynamically retrieve the backend end-point. For multiple environments, the same docker image could be used while moving from TST to ACC for example."><meta property="twitter:image" content="https://giwan.github.io/blog/2018-11-22-react-served-by-express-running-in-docker//placeholder-social.jpg"><!-- Tailwind Typography plugin with One Dark Pro theme --><meta name="theme-color" content="#272822"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet"><script type="module">(function(){function s(){const t=localStorage.getItem("theme");return typeof t=="string"?t==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":t:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const r=s(),e=document.documentElement;r==="dark"?(e.classList.add("dark"),e.setAttribute("data-theme","dark")):(e.classList.remove("dark"),e.setAttribute("data-theme","light"))})();</script><link rel="stylesheet" href="/_astro/about.GS-pjZqL.css">
<link rel="stylesheet" href="/_astro/index.Cgakj-7q.css"></head> <body class="bg-background min-h-screen font-sans text-foreground leading-relaxed"> <div class="mx-auto max-w-8xl p-4 sm:p-6 lg:p-8"> <header class="block w-full"> <div class="grid grid-cols-2"> <div class="col-span-1"> <div class="flex flex-col"><div class="mb-2"><h1 class="font-heading text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight text-primary mb-1"><a href="/" class="hover:opacity-90 transition-opacity">G1</a></h1></div></div> </div> <div class="col-span-1 flex justify-end items-center gap-2 sm:flex-row"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1R0K2F" prefix="r1" component-url="/_astro/ThemeToggle.BLwwZFmV.js" component-export="ThemeToggle" renderer-url="/_astro/client.BXWm451Q.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}" await-children><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9" title="Switch to light mode"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor h-4 w-4" aria-hidden="true"><rect width="20" height="14" x="2" y="3" rx="2"></rect><line x1="8" x2="16" y1="21" y2="21"></line><line x1="12" x2="12" y1="17" y2="21"></line></svg><span class="sr-only">Switch to light mode</span></button><!--astro:end--></astro-island> <nav aria-label="Main navigation"> <!-- Desktop Navigation --> <div class="hidden sm:flex justify-end items-center bg-secondary text-secondary-foreground rounded-sm gap-1"> <a href="/" class="inline-block no-underline text-sm font-medium px-3 py-1 rounded transition-all duration-200 hover:bg-muted/20 font-medium text-secondary-foreground hover:bg-accent focus:bg-accent focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-secondary transition-colors duration-200 rounded-sm text-base" aria-label="Navigate to Articles"> Articles </a><a href="/tools" class="inline-block no-underline text-sm font-medium px-3 py-1 rounded transition-all duration-200 hover:bg-muted/20 font-medium text-secondary-foreground hover:bg-accent focus:bg-accent focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-secondary transition-colors duration-200 rounded-sm text-base" aria-label="Navigate to Tools"> Tools </a><a href="/search" class="inline-block no-underline text-sm font-medium px-3 py-1 rounded transition-all duration-200 hover:bg-muted/20 font-medium text-secondary-foreground hover:bg-accent focus:bg-accent focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-secondary transition-colors duration-200 rounded-sm text-base" aria-label="Navigate to Search"> Search </a><a href="/about" class="inline-block no-underline text-sm font-medium px-3 py-1 rounded transition-all duration-200 hover:bg-muted/20 font-medium text-secondary-foreground hover:bg-accent focus:bg-accent focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-secondary transition-colors duration-200 rounded-sm text-base" aria-label="Navigate to About"> About </a> </div> <!-- Mobile Navigation --> <div class="sm:hidden"> <astro-island uid="Z1pz40O" prefix="r2" component-url="/_astro/HeaderNav.CW60Fs3y.js" component-export="default" renderer-url="/_astro/client.BXWm451Q.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;HeaderNavMobile&quot;,&quot;value&quot;:true}" await-children><div class="relative"><button class="menu-button mb-1 bg-primary text-background rounded-sm flex flex-col items-center justify-center space-y-1.5 w-12 h-12 shadow-lg hover:bg-accent focus:bg-accent focus:outline-none focus:ring-2 focus:ring-syntax-purple transition-all duration-200 hover:shadow-xl" aria-label="Toggle menu"><span class="block w-6 h-0.5 bg-background transition-all duration-300 "></span><span class="block w-6 h-0.5 bg-background transition-all duration-300 opacity-100"></span><span class="block w-6 h-0.5 bg-background transition-all duration-300 "></span></button></div><!--astro:end--></astro-island> </div> </nav> </div> <div class="col-span-2 w-full flex justify-between border-t border-border py-1 font-sans font-bold text-sm text-muted-foreground"> <p> Monday, 30 June 2025 —  <span class="hidden sm:inline">
Exploring code & technology
</span> </p> <p>
VOL. 23 • ISSUE 42
</p> </div> </div> </header>  <div class="max-w-4xl my-12"> <!-- Article Header --> <header class="mb-8 pb-6"> <!-- Categories -->  <!-- Title --> <h1 class="text-4xl font-bold text-foreground mb-4"> React App Served by Express in Docker </h1> <!-- Metadata Row --> <div class="flex flex-wrap items-center justify-end text-sm text-muted-foreground"> <span class="mr-3">November 22, 2018</span>  </div> </header> <!-- Hero Image -->  <!-- Article Content --> <div class="prose prose-lg max-w-none prose-headings:text-foreground prose-headings:font-semibold prose-p:text-foreground prose-a:text-primary prose-a:underline prose-strong:text-foreground prose-ul:text-foreground prose-ol:text-foreground prose-li:text-foreground prose-li:marker:text-muted-foreground prose-code:bg-muted prose-code:text-muted-foreground prose-code:px-1 prose-code:py-0.5 prose-code:rounded-sm prose-blockquote:border-l-border prose-blockquote:text-muted-foreground prose-th:text-foreground prose-td:text-foreground"> <p>Running in Docker requires special considerations in the front-end. It should dynamically retrieve the backend end-point. For multiple environments, the same docker image could be used while moving from TST to ACC for example.
Build a Docker container and the static assets are fixed.</p>
<h2 id="back-end-service-on-the-same-host">Back-end service on the same host</h2>
<p>A front-end client is running in a docker container will likely need data from a back-end service. On the same domain, requests can simply be pointed to <code>/api/xyz</code>. No domain host is specified. The domain of the client applies.</p>
<h2 id="third-party-service-is-only-known-at-runtime">Third-party service is only known at runtime</h2>
<p>Data from third-party services, <strong>not on the same host</strong>, are more complicated. It may be possible to inject the third-party host domain at build time. The case below is when the third-party host domain is only known at <strong>runtime</strong>.</p>
<h2 id="technology-stack">Technology stack</h2>
<ul>
<li>Docker</li>
<li>NodeJS</li>
<li>Express</li>
<li>React —&gt; static assets (html, css, javascript)</li>
</ul>
<p>A very simple react application.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// --- app.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> React </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { render } </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react-dom&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#A6E22E"> App</span><span style="color:#F92672"> =</span><span style="color:#F8F8F2"> () </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> &lt;</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;Hello World&lt;/</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">render</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#F8F8F2"> /&gt;, document.</span><span style="color:#A6E22E">getElementById</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;root&quot;</span><span style="color:#F8F8F2">));</span></span></code></pre>
<p>Data is retrieved from a TST backend when the component is mounted.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// --- app.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> React </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { render } </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react-dom&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">class</span><span> </span><span style="color:#A6E22E;text-decoration:underline">App</span><span style="color:#F92672"> extends</span><span> </span><span style="color:#A6E22E;text-decoration:underline">React</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;font-style:italic;text-decoration:underline">Component</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    constructor</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">props</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FD971F">        super</span><span style="color:#F8F8F2">(props);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FD971F">        this</span><span style="color:#F8F8F2">.state </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">            data: </span><span style="color:#AE81FF">null</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">        };</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">    /**</span></span>
<span class="line"><span style="color:#88846F">     * When the component mounts,</span></span>
<span class="line"><span style="color:#88846F">     * fetch the data from the network</span></span>
<span class="line"><span style="color:#88846F">     */</span></span>
<span class="line"><span style="color:#F92672">    async</span><span style="color:#A6E22E"> componentDidMount</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">        try</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> res </span><span style="color:#F92672">=</span><span style="color:#F92672"> await</span><span style="color:#A6E22E"> fetch</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;/api/data&quot;</span><span style="color:#F8F8F2">); </span><span style="color:#88846F">// fetch the data</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> jsonData </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> res.status </span><span style="color:#F92672">===</span><span style="color:#AE81FF"> 200</span><span style="color:#F92672"> ?</span><span style="color:#F92672"> await</span><span style="color:#F8F8F2"> res.</span><span style="color:#A6E22E">json</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> res;</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> (jsonData.status </span><span style="color:#F92672">===</span><span style="color:#AE81FF"> 200</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FD971F">                this</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E">setState</span><span style="color:#F8F8F2">({ data: jsonData });</span></span>
<span class="line"><span style="color:#F8F8F2">            } </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">                throw</span><span style="color:#F92672"> new</span><span style="color:#A6E22E"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">`Expected JSON data but received: </span><span style="color:#F92672">${</span><span style="color:#F8F8F2">jsonData</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">        } </span><span style="color:#F92672">catch</span><span style="color:#F8F8F2"> (error) {</span></span>
<span class="line"><span style="color:#F8F8F2">            console.</span><span style="color:#A6E22E">error</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;failed to fetch data&quot;</span><span style="color:#F8F8F2">, error);</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">    render</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">        return</span><span style="color:#F8F8F2"> &lt;</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;Hello </span><span style="color:#F92672">{</span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.state.data</span><span style="color:#F92672">}</span><span style="color:#F8F8F2">&lt;/</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">render</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#F8F8F2"> /&gt;, document.</span><span style="color:#A6E22E">getElementById</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;root&quot;</span><span style="color:#F8F8F2">));</span></span></code></pre>
<p>The above code uses the endpoint <code>/api/data</code> to get the data it needs. If the front-end is running on <code>http://localhost:3000</code>, then the API request will got to <code>http://localhost:3000/api/data</code>. (Providing there is no proxy configured).</p>
<p>In our case we would like the API request to go to a different host. The challenging part is that we do not know which host this is until later (at runtime).</p>
<p>In the case of a non-dockerized React application, use the environment variables available at build time. These start with <code>REACT_APP_</code>. <a href="https://create-react-app.dev/docs/adding-custom-environment-variables/">https://create-react-app.dev/docs/adding-custom-environment-variables/</a></p>
<p>Building the front-end production version results in the <code>apiHost</code> value being populated correctly. These can be specified in local <code>.env</code> file where react would read them at build time.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#88846F"># -- .env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">REACT_APP_API_HOST</span><span style="color:#F92672">=</span><span style="color:#E6DB74">http://someremotehost.com</span></span></code></pre>
<p>Build the application with <code>npm run build</code>. The remote host is inserted, replacing <code>REACT_APP_API_HOST</code> where ever it’s used.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// --- app.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> React </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { render } </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react-dom&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">class</span><span> </span><span style="color:#A6E22E;text-decoration:underline">App</span><span style="color:#F92672"> extends</span><span> </span><span style="color:#A6E22E;text-decoration:underline">React</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E;font-style:italic;text-decoration:underline">Component</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    constructor</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">props</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FD971F">        super</span><span style="color:#F8F8F2">(props);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FD971F">        this</span><span style="color:#F8F8F2">.state </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">            data: </span><span style="color:#AE81FF">null</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">        };</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">    /**</span></span>
<span class="line"><span style="color:#88846F">     * When the component is mounted,</span></span>
<span class="line"><span style="color:#88846F">     * fetch the data from the network</span></span>
<span class="line"><span style="color:#88846F">     */</span></span>
<span class="line"><span style="color:#F92672">    async</span><span style="color:#A6E22E"> componentDidMount</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">        try</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> res </span><span style="color:#F92672">=</span><span style="color:#F92672"> await</span><span style="color:#A6E22E"> fetch</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">                `</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">process.env.REACT_APP_API_HOST</span><span style="color:#F92672">}</span><span style="color:#E6DB74">/api/data`</span></span>
<span class="line"><span style="color:#F8F8F2">            ); </span><span style="color:#88846F">// fetch the data</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> jsonData </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> res.status </span><span style="color:#F92672">===</span><span style="color:#AE81FF"> 200</span><span style="color:#F92672"> ?</span><span style="color:#F92672"> await</span><span style="color:#F8F8F2"> res.</span><span style="color:#A6E22E">json</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> res;</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> (jsonData.status </span><span style="color:#F92672">===</span><span style="color:#AE81FF"> 200</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FD971F">                this</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E">setState</span><span style="color:#F8F8F2">({ data: jsonData });</span></span>
<span class="line"><span style="color:#F8F8F2">            } </span><span style="color:#F92672">else</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">                throw</span><span style="color:#F92672"> new</span><span style="color:#A6E22E"> Error</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">`Expected JSON data but received: </span><span style="color:#F92672">${</span><span style="color:#F8F8F2">jsonData</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"><span style="color:#F8F8F2">        } </span><span style="color:#F92672">catch</span><span style="color:#F8F8F2"> (error) {</span></span>
<span class="line"><span style="color:#F8F8F2">            console.</span><span style="color:#A6E22E">error</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;failed to fetch data&quot;</span><span style="color:#F8F8F2">, error);</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">    render</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">        return</span><span style="color:#F8F8F2"> &lt;</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;Hello </span><span style="color:#F92672">{</span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.state.data</span><span style="color:#F92672">}</span><span style="color:#F8F8F2">&lt;/</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">render</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#F8F8F2"> /&gt;, document.</span><span style="color:#A6E22E">getElementById</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;root&quot;</span><span style="color:#F8F8F2">));</span></span></code></pre>
<blockquote>
<p>What if the host is not available at build time? Only at runtime?</p>
</blockquote>
<h2 id="running-in-docker">Running in Docker</h2>
<p>Docker adds another layer of complexity. The idea of a Docker image is build it once and run it in various places.
In the case the docker image should be re-used for for TST on ACC and, PRD.
Once the Docker image is built <code>docker build</code>, it’s not easy to inject variable values.</p>
<p>Running in docker, the front-end uses a server.
That server, A node / express server, can be used to provide the <strong><code>apiHost</code></strong> to the front-end.</p>
<ol>
<li>Starting the Docker container, environment variables are provided at run time</li>
<li>The container receives and passes the environment variables on to the express server</li>
<li>The express server passes that variable to the front-end</li>
</ol>
<div class="grid gap-4 md:grid-cols-2 lg:grid-cols-4"><div class="rounded-lg border bg-card text-card-foreground shadow-sm cursor-pointer hover:bg-muted/50 transition-colors"><div class="p-4"><button class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground w-full h-auto p-0 justify-start text-left"><div class="w-full"><div class="font-semibold">ENV_VARS<!-- --> <span class="text-accent ml-2">➔</span></div></div></button></div></div><div class="rounded-lg border bg-card text-card-foreground shadow-sm cursor-pointer hover:bg-muted/50 transition-colors"><div class="p-4"><button class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground w-full h-auto p-0 justify-start text-left"><div class="w-full"><div class="font-semibold">Docker container<!-- --> <span class="text-accent ml-2">➔</span></div></div></button></div></div><div class="rounded-lg border bg-card text-card-foreground shadow-sm cursor-pointer hover:bg-muted/50 transition-colors"><div class="p-4"><button class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground w-full h-auto p-0 justify-start text-left"><div class="w-full"><div class="font-semibold">Express server<!-- --> <span class="text-accent ml-2">➔</span></div></div></button></div></div><div class="rounded-lg border bg-card text-card-foreground shadow-sm cursor-pointer hover:bg-muted/50 transition-colors"><div class="p-4"><button class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground w-full h-auto p-0 justify-start text-left"><div class="w-full"><div class="font-semibold">Front-end<!-- --> <span class="text-accent ml-2">➔</span></div></div></button></div></div></div>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#88846F"># run docker image with environment variables</span></span>
<span class="line"><span style="color:#A6E22E">docker</span><span style="color:#E6DB74"> run</span><span style="color:#AE81FF"> -e</span><span style="color:#E6DB74"> &quot;API_HOST=https://mydockerdynamichost.com&quot;</span><span style="color:#AE81FF"> -p</span><span style="color:#E6DB74"> 3000:3000</span><span style="color:#E6DB74"> mydockerimagename</span></span>
<span class="line"></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be">The complete source on GitHub</a></p>
<h2 id="slow-data-retrieval">Slow data retrieval</h2>
<p>This is a workable solution. There are downsides though.
The front-end has to request the host before any data requests are possible.
Network latency means that our application is slower.
The next section discusses a solution. Server side rendering.</p>
<h1 id="server-side-rendering-to-provide-the-api-host">Server Side Rendering to provide the API HOST</h1>
<p>Using server side rendering in the Docker container, the app rendered on the server.
It’s also sent to the client.
The API HOST variable is provided right away. The need for an additional network request is removed.
Initial data should also be loaded before responding to the client.</p>
<p>First ensure the app expects the <code>apiHost</code> as a prop.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// -- src/app.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> React, { Component } </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> &quot;./App.css&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">class</span><span> </span><span style="color:#A6E22E;text-decoration:underline">App</span><span style="color:#F92672"> extends</span><span> </span><span style="color:#A6E22E;font-style:italic;text-decoration:underline">Component</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#A6E22E">    render</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">        return</span><span style="color:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#F8F8F2">            &lt;</span><span style="color:#F92672">div</span><span style="color:#A6E22E"> className</span><span style="color:#F92672">=</span><span style="color:#E6DB74">&quot;App&quot;</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">                &lt;</span><span style="color:#F92672">h1</span><span style="color:#F8F8F2">&gt;Sample app testing dynamic backend&lt;/</span><span style="color:#F92672">h1</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">                &lt;</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;Loaded backend host: </span><span style="color:#F92672">{</span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.props.</span><span style="color:#E6DB74">`apiHost`</span><span style="color:#F92672">}</span><span style="color:#F8F8F2"> &lt;/</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">            &lt;/</span><span style="color:#F92672">div</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">        );</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">export</span><span style="color:#F92672"> default</span><span style="color:#F8F8F2"> App;</span></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be/blob/ssr/src/App.js">source: app.js</a></p>
<p>Also during Hydration is the <code>apiHost</code> required. During the render step on the server it will become clear why the variable <code>__API_HOST__</code> is a global on the window object.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// -- src/index.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> React </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> { render, hydrate } </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;react-dom&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> &quot;./index.css&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> App </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;./App&quot;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> apiHost </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> window.__API_HOST__;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> root </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> document.</span><span style="color:#A6E22E">getElementById</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;root&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * If childNodes exist, then server rendering</span></span>
<span class="line"><span style="color:#88846F"> * happened and we only need to hydrate</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#F8F8F2">root.</span><span style="color:#A6E22E">hasChildNodes</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F92672">    ?</span><span style="color:#A6E22E"> hydrate</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#A6E22E"> apiHost</span><span style="color:#F92672">={</span><span style="color:#F8F8F2">apiHost</span><span style="color:#F92672">}</span><span style="color:#F8F8F2"> /&gt;, root)</span></span>
<span class="line"><span style="color:#F92672">    :</span><span style="color:#A6E22E"> render</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#A6E22E"> apiHost</span><span style="color:#F92672">={</span><span style="color:#F8F8F2">apiHost</span><span style="color:#F92672">}</span><span style="color:#F8F8F2"> /&gt;, root);</span></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be/blob/ssr/src/index.js">source: index.js</a></p>
<h2 id="server-side-rendering">Server side rendering</h2>
<p>To setup server side rendering (SSR), create a folder named <code>server</code> in the root folder of the project. The render is divided into three files.</p>
<ol>
<li>server.js <em>(including required files for JSX and ES6 imports)</em></li>
<li>router.js <em>(routing to direct network requests)</em></li>
<li>renderer.js <em>(actually render the app on the server and respond to the client)</em></li>
</ol>
<h3 id="serverjs">Server.js</h3>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// -- server/server.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * (pre)Load the necessary libraries to ensure</span></span>
<span class="line"><span style="color:#88846F"> * the react app can be built on the server.</span></span>
<span class="line"><span style="color:#88846F"> * -- Normally these are loaded by webpack --</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#A6E22E">require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;ignore-styles&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#A6E22E">require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;url-loader&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#A6E22E">require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;file-loader&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#A6E22E">require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;@babel/polyfill&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#A6E22E">require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;@babel/register&quot;</span><span style="color:#F8F8F2">)({</span></span>
<span class="line"><span style="color:#F8F8F2">    presets: [</span><span style="color:#E6DB74">&quot;@babel/preset-env&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">&quot;@babel/preset-react&quot;</span><span style="color:#F8F8F2">],</span></span>
<span class="line"><span style="color:#F8F8F2">    plugins: [</span></span>
<span class="line"><span style="color:#E6DB74">        &quot;@babel/plugin-syntax-dynamic-import&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E6DB74">        &quot;@babel/plugin-proposal-export-default-from&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    ],</span></span>
<span class="line"><span style="color:#F8F8F2">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/** --- Now load the application as normal --- */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> express </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;express&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> router </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;./router&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Initiate App</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> app </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> express</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> { PORT </span><span style="color:#F92672">=</span><span style="color:#AE81FF"> 3000</span><span style="color:#F8F8F2"> } </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> process.env; </span><span style="color:#88846F">// default to 3000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * Tell the app to use the router imported above</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#F8F8F2">app.</span><span style="color:#A6E22E">use</span><span style="color:#F8F8F2">(router);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// start the express server and log what port it&#39;s running on</span></span>
<span class="line"><span style="color:#F8F8F2">app.</span><span style="color:#A6E22E">listen</span><span style="color:#F8F8F2">(PORT, () </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> console.</span><span style="color:#A6E22E">log</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">`running on http://localhost:</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">PORT</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span><span style="color:#F8F8F2">));</span></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be/blob/ssr/server/server.js">source: server.js</a></p>
<h3 id="routerjs">Router.js</h3>
<p>Next add the router.js file.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// -- server/router.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// -- server/router.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> express </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;express&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> path </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;path&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> serverRenderer </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;./serverRenderer&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * Create the router object</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> router </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> express.</span><span style="color:#A6E22E">Router</span><span style="color:#F8F8F2">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * this route will not be used if server side rendering</span></span>
<span class="line"><span style="color:#88846F"> * works properly.</span></span>
<span class="line"><span style="color:#88846F"> * However getting this route will require an additional</span></span>
<span class="line"><span style="color:#88846F"> * request to be sent to the server.</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#F8F8F2">router.</span><span style="color:#A6E22E">get</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;/environment.json&quot;</span><span style="color:#F8F8F2">, ({}, </span><span style="color:#FD971F;font-style:italic">response</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    response.</span><span style="color:#A6E22E">json</span><span style="color:#F8F8F2">({</span></span>
<span class="line"><span style="color:#F8F8F2">        apiHost: </span><span style="color:#E6DB74">&quot;http://somehost.com&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    });</span></span>
<span class="line"><span style="color:#F8F8F2">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// root (/) should always serve our server rendered page</span></span>
<span class="line"><span style="color:#88846F">// serverRenderer will be discussed in the next section.</span></span>
<span class="line"><span style="color:#F8F8F2">router.</span><span style="color:#A6E22E">use</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;^/$&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#A6E22E">serverRenderer</span><span style="color:#F8F8F2">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Static assets should just be accessible</span></span>
<span class="line"><span style="color:#F8F8F2">router.</span><span style="color:#A6E22E">use</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    express.</span><span style="color:#A6E22E">static</span><span style="color:#F8F8F2">(path.</span><span style="color:#A6E22E">resolve</span><span style="color:#F8F8F2">(__dirname, </span><span style="color:#E6DB74">&quot;..&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">&quot;build&quot;</span><span style="color:#F8F8F2">), {</span></span>
<span class="line"><span style="color:#F8F8F2">        maxAge: </span><span style="color:#E6DB74">&quot;30d&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    })</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">/**</span></span>
<span class="line"><span style="color:#88846F"> * Ensures the front-end source and assets are still</span></span>
<span class="line"><span style="color:#88846F"> * found if the user refreshes the page on a deep route:</span></span>
<span class="line"><span style="color:#88846F"> * /book/com.mytoori.book.sample4</span></span>
<span class="line"><span style="color:#88846F"> * If this route is not here the front-end assets are not found</span></span>
<span class="line"><span style="color:#88846F"> */</span></span>
<span class="line"><span style="color:#F8F8F2">router.</span><span style="color:#A6E22E">use</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;^(?!api$)&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#A6E22E">serverRenderer</span><span style="color:#F8F8F2">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">module</span><span style="color:#F8F8F2">.</span><span style="color:#66D9EF;font-style:italic">exports</span><span style="color:#F92672"> =</span><span style="color:#F8F8F2"> router;</span></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be/blob/ssr/server/router.js">source: router.js</a></p>
<h3 id="rendererjs">Renderer.js</h3>
<p>Before the app is rendered, read the <code>API_HOST</code> environment variable from <code>process.env</code>.
As part of the rendering step the <code>API_HOST</code> is provided as a prop.
The variable is added to the HTML file so it can be picked up on the client and used during the <strong>Hydration</strong> step.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="js"><code><span class="line"><span style="color:#88846F">// -- server/renderer.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> React </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;react&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> { renderToString } </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;react-dom/server&quot;</span><span style="color:#F8F8F2">); </span><span style="color:#88846F">// renders react app to string</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> fs </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;fs&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> path </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> require</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;path&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> { API_HOST </span><span style="color:#F92672">=</span><span style="color:#E6DB74"> &quot;http://fallbackapihost.com&quot;</span><span style="color:#F8F8F2"> } </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> process.env;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> App </span><span style="color:#F92672">from</span><span style="color:#E6DB74"> &quot;../src/App&quot;</span><span style="color:#F8F8F2">; </span><span style="color:#88846F">// import the app that is going to be rendered on the server</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> indexFilePath </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> path.</span><span style="color:#A6E22E">resolve</span><span style="color:#F8F8F2">(__dirname, </span><span style="color:#E6DB74">&quot;..&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">&quot;build&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">&quot;index.html&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">const</span><span style="color:#F8F8F2"> serverRenderer </span><span style="color:#F92672">=</span></span>
<span class="line"><span style="color:#F8F8F2">    () </span><span style="color:#66D9EF;font-style:italic">=&gt;</span></span>
<span class="line"><span style="color:#F92672">    async</span><span style="color:#F8F8F2"> ({}, </span><span style="color:#FD971F;font-style:italic">response</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">        // read the public/index.html file into memory</span></span>
<span class="line"><span style="color:#88846F">        // The rendered html string is then inserted</span></span>
<span class="line"><span style="color:#88846F">        // and sent to the client</span></span>
<span class="line"><span style="color:#F8F8F2">        fs.</span><span style="color:#A6E22E">readFile</span><span style="color:#F8F8F2">(indexFilePath, </span><span style="color:#E6DB74">&quot;utf8&quot;</span><span style="color:#F8F8F2">, (</span><span style="color:#FD971F;font-style:italic">err</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">indexHTMLFile</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=&gt;</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> (err) {</span></span>
<span class="line"><span style="color:#F8F8F2">                console.</span><span style="color:#A6E22E">error</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">&quot;Failed to read index.html &quot;</span><span style="color:#F8F8F2">, err);</span></span>
<span class="line"><span style="color:#F92672">                return</span><span style="color:#F8F8F2"> response.</span><span style="color:#A6E22E">status</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">404</span><span style="color:#F8F8F2">).</span><span style="color:#A6E22E">end</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">            // Render the entire React app to HTML string</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> renderedHTML </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> renderToString</span><span style="color:#F8F8F2">(&lt;</span><span style="color:#66D9EF;font-style:italic">App</span><span style="color:#A6E22E"> apiHost</span><span style="color:#F92672">={</span><span style="color:#F8F8F2">API_HOST</span><span style="color:#F92672">}</span><span style="color:#F8F8F2"> /&gt;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">            // Add (Global) variable with data to</span></span>
<span class="line"><span style="color:#88846F">            // the client window object</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">            const</span><span style="color:#F8F8F2"> initialData </span><span style="color:#F92672">=</span><span style="color:#E6DB74"> `</span></span>
<span class="line"><span style="color:#E6DB74">            &lt;script&gt;</span></span>
<span class="line"><span style="color:#E6DB74">                window.__API_HOST__ = &quot;</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">API_HOST</span><span style="color:#F92672">}</span><span style="color:#E6DB74">&quot;</span></span>
<span class="line"><span style="color:#E6DB74">            &lt;/script&gt;</span></span>
<span class="line"><span style="color:#E6DB74">        `</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">            return</span><span style="color:#F8F8F2"> response.</span><span style="color:#A6E22E">send</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">                indexHTMLFile.</span><span style="color:#A6E22E">replace</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">                    &#39;&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;&#39;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E6DB74">                    `&lt;div id=&quot;root&quot;&gt;</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">renderedHTML</span><span style="color:#F92672">}</span><span style="color:#E6DB74">&lt;/div&gt;</span><span style="color:#F92672">${</span><span style="color:#F8F8F2">initialData</span><span style="color:#F92672">}</span><span style="color:#E6DB74">`</span></span>
<span class="line"><span style="color:#F8F8F2">                )</span></span>
<span class="line"><span style="color:#F8F8F2">            );</span></span>
<span class="line"><span style="color:#F8F8F2">        });</span></span>
<span class="line"><span style="color:#F8F8F2">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">module</span><span style="color:#F8F8F2">.</span><span style="color:#66D9EF;font-style:italic">exports</span><span style="color:#F92672"> =</span><span style="color:#F8F8F2"> serverRenderer;</span></span></code></pre>
<p><a href="https://github.com/Giwan/fe-docker-dynamic-be/blob/ssr/server/serverRenderer.js">source: renderer.js</a></p>
<h3 id="running-in-docker-1">Running in Docker</h3>
<p>The entire project can also be executed in a docker container. Copy the following to run the project in docker. It will build the project and run the start command when finished to start the project.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#88846F"># Use the following image to build this docker image</span></span>
<span class="line"><span style="color:#88846F"># This is pulled from docker.com and has everything</span></span>
<span class="line"><span style="color:#88846F"># needed to run a node project</span></span>
<span class="line"><span style="color:#A6E22E">FROM</span><span style="color:#E6DB74"> node:alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># Back_env is set during build</span></span>
<span class="line"><span style="color:#88846F"># telling the front-end which back-end</span></span>
<span class="line"><span style="color:#88846F"># it should be talking to</span></span>
<span class="line"><span style="color:#88846F"># ARG backend_env</span></span>
<span class="line"><span style="color:#88846F"># ENV BACKEND_ENV $backend_env</span></span>
<span class="line"><span style="color:#A6E22E">ENV</span><span style="color:#E6DB74"> PORT</span><span style="color:#AE81FF"> 3000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># Navigate (cd) to the app folder in the docker container</span></span>
<span class="line"><span style="color:#A6E22E">WORKDIR</span><span style="color:#E6DB74"> /usr/src/app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># Copy all package.json / package-lock.json etc. to the root folder</span></span>
<span class="line"><span style="color:#88846F"># this is executed on build: docker build .</span></span>
<span class="line"><span style="color:#A6E22E">COPY</span><span style="color:#E6DB74"> ./package</span><span style="color:#FD971F">*</span><span style="color:#E6DB74">.json</span><span style="color:#E6DB74"> ./</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">RUN</span><span style="color:#E6DB74"> npm</span><span style="color:#E6DB74"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># copy everything from the external directory to the container folder in docker</span></span>
<span class="line"><span style="color:#A6E22E">COPY</span><span style="color:#E6DB74"> .</span><span style="color:#E6DB74"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># build the front-end with react build scripts and store them in the build folder</span></span>
<span class="line"><span style="color:#A6E22E">RUN</span><span style="color:#E6DB74"> npm</span><span style="color:#E6DB74"> run</span><span style="color:#E6DB74"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">EXPOSE</span><span style="color:#AE81FF"> 3000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">CMD</span><span style="color:#F8F8F2"> [</span><span style="color:#E6DB74">&quot;npm&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">&quot;run&quot;,</span><span style="color:#E6DB74"> &quot;start:prod&quot;]</span></span></code></pre>
<h4 id="starting-up">starting up</h4>
<p>The start:prod command initiates the node process with the server/server.js file.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="json"><code><span class="line"><span style="color:#E6DB74">&quot;start:prod&quot;</span><span style="color:#F8F8F2">: </span><span style="color:#E6DB74">&quot;NODE_ENV=production node ./server/server.js&quot;</span><span style="color:#F8F8F2">,</span></span></code></pre>
<p>To test outside of Docker, simply run <code>npm run start:prod</code> from the terminal.</p>
<p>While running the docker container the API host is provided as an environment variable. That is then read when rendering the app on the server.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#88846F"># build docker</span></span>
<span class="line"><span style="color:#A6E22E">docker</span><span style="color:#E6DB74"> build</span><span style="color:#AE81FF"> -t</span><span style="color:#E6DB74"> mydockercontainer</span><span style="color:#E6DB74"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># run docker container with environment variable</span></span>
<span class="line"><span style="color:#A6E22E">docker</span><span style="color:#E6DB74"> run</span><span style="color:#AE81FF"> -e</span><span style="color:#E6DB74"> &quot;API_HOST=https://dockerruntimeapihost.com&quot;</span><span style="color:#AE81FF"> -p</span><span style="color:#E6DB74"> 3000:3000</span><span style="color:#E6DB74"> mydockercontainer</span></span></code></pre> </div> <!-- Article Footer --> <footer class="mt-12 pt-6 border-t border-border"> <!-- Tags -->  <!-- Share and Related Articles --> <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center"> <div class="mb-4 sm:mb-0"> <h3 class="text-sm uppercase tracking-wider text-muted-foreground mb-2">Share this article</h3> <div class="flex space-x-3"> <a href="https://mastodon.social/@giwan" class="text-muted-foreground hover:text-primary transition-colors" rel="me"> <span class="sr-only">Mastodon</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545z"></path> </svg> </a> <a href="mailto:giwan@giwan.id" class="text-muted-foreground hover:text-primary transition-colors"> <span class="sr-only">Email</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path> </svg> </a> <a href="https://www.linkedin.com/in/giwan/" class="text-muted-foreground hover:text-primary transition-colors"> <span class="sr-only">LinkedIn</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"></path> </svg> </a> </div> </div> <a href="/articles" class="inline-flex items-center font-semibold text-foreground hover:text-primary transition-colors"> <span>More articles</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path> </svg> </a> </div> </footer> </div>  <footer class="mt-12 border-t pt-8 pb-12"> <div class="max-w-3xl text-muted-foreground"> <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8"> <div class="text-left"> <h3 class="text-xl text-foreground font-semibold mb-4">G1</h3> <p class="mb-4">Exploring code and technology - delivered with clarity and insight.</p> <p class="text-sm">&copy; 2025 G1. All rights reserved.</p> </div> <div class="text-left"> <h3 class="text-lg text-foreground font-medium mb-4">Categories</h3> <ul class="space-y-2"> <li><a href="/" class="text-muted-foreground hover:text-primary transition-colors">Articles</a></li> <li><a href="/tools" class="text-muted-foreground hover:text-primary transition-colors">Tools</a></li> <li><a href="/search" class="text-muted-foreground hover:text-primary transition-colors">Search</a></li> <li><a href="/about" class="text-muted-foreground hover:text-primary transition-colors">About</a></li> </ul> </div> <div class="text-left"> <h3 class="text-lg text-foreground font-medium mb-4">Connect</h3> <ul class="space-y-2"> <li><a href="/contact" class="text-muted-foreground hover:text-primary transition-colors">Contact</a></li> <li><a href="/rss.xml" class="text-muted-foreground hover:text-primary transition-colors">RSS Feed</a></li> <li><a href="https://github.com/giwan" class="text-muted-foreground hover:text-primary transition-colors">GitHub</a></li> </ul> </div> </div> </div> </footer> </div> </body></html>