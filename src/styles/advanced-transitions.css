/**
 * Advanced Transition Animations
 * 
 * This file contains complex transition animations and advanced transition:animate directives
 * for sophisticated page transitions and element animations.
 */

/* Advanced transition:animate directives for complex animations */

/* Staggered list item animations */
@keyframes stagger-fade-in {
  from {
    opacity: 0;
    transform: translate3d(0, 20px, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes stagger-fade-out {
  from {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  to {
    opacity: 0;
    transform: translate3d(0, -20px, 0);
  }
}

/* Complex morphing transitions */
@keyframes morph-expand {
  0% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
    border-radius: 8px;
  }
  50% {
    opacity: 0.8;
    transform: scale3d(1.1, 0.9, 1);
    border-radius: 16px;
  }
  100% {
    opacity: 0;
    transform: scale3d(1.2, 0.8, 1);
    border-radius: 24px;
  }
}

@keyframes morph-contract {
  0% {
    opacity: 0;
    transform: scale3d(0.8, 1.2, 1);
    border-radius: 24px;
  }
  50% {
    opacity: 0.8;
    transform: scale3d(0.9, 1.1, 1);
    border-radius: 16px;
  }
  100% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
    border-radius: 8px;
  }
}

/* Elastic bounce transitions */
@keyframes elastic-in {
  0% {
    opacity: 0;
    transform: scale3d(0.3, 0.3, 1);
  }
  20% {
    transform: scale3d(1.1, 1.1, 1);
  }
  40% {
    transform: scale3d(0.9, 0.9, 1);
  }
  60% {
    opacity: 1;
    transform: scale3d(1.03, 1.03, 1);
  }
  80% {
    transform: scale3d(0.97, 0.97, 1);
  }
  100% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
  }
}

@keyframes elastic-out {
  0% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
  }
  20% {
    transform: scale3d(0.97, 0.97, 1);
  }
  40% {
    transform: scale3d(1.03, 1.03, 1);
  }
  60% {
    opacity: 1;
    transform: scale3d(0.9, 0.9, 1);
  }
  80% {
    transform: scale3d(1.1, 1.1, 1);
  }
  100% {
    opacity: 0;
    transform: scale3d(0.3, 0.3, 1);
  }
}

/* Flip card transitions */
@keyframes flip-out-y {
  0% {
    opacity: 1;
    transform: perspective(400px) rotateY(0deg);
  }
  100% {
    opacity: 0;
    transform: perspective(400px) rotateY(90deg);
  }
}

@keyframes flip-in-y {
  0% {
    opacity: 0;
    transform: perspective(400px) rotateY(-90deg);
  }
  100% {
    opacity: 1;
    transform: perspective(400px) rotateY(0deg);
  }
}

/* Slide and rotate combinations */
@keyframes slide-rotate-out {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
  100% {
    opacity: 0;
    transform: translate3d(-100px, 0, 0) rotate(-5deg);
  }
}

@keyframes slide-rotate-in {
  0% {
    opacity: 0;
    transform: translate3d(100px, 0, 0) rotate(5deg);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
}

/* Zoom and blur effects */
@keyframes zoom-blur-out {
  0% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
    filter: blur(0px);
  }
  100% {
    opacity: 0;
    transform: scale3d(1.1, 1.1, 1);
    filter: blur(5px);
  }
}

@keyframes zoom-blur-in {
  0% {
    opacity: 0;
    transform: scale3d(0.9, 0.9, 1);
    filter: blur(5px);
  }
  100% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
    filter: blur(0px);
  }
}

/* Advanced transition configurations */

/* Staggered article list transitions */
[data-transition-context="article-list-advanced"] {
  --exit-animation: stagger-fade-out;
  --enter-animation: stagger-fade-in;
}

[data-transition-context="article-list-advanced"] ::view-transition-old(main-content) {
  animation: var(--exit-animation) var(--transition-duration-normal) var(--transition-easing-standard);
  animation-delay: calc(var(--stagger-delay, 0) * 50ms);
}

[data-transition-context="article-list-advanced"] ::view-transition-new(main-content) {
  animation: var(--enter-animation) var(--transition-duration-normal) var(--transition-easing-standard);
  animation-delay: calc(var(--stagger-delay, 0) * 50ms);
}

/* Morphing transitions for card-like elements */
[data-transition-context="morph"] {
  --exit-animation: morph-expand;
  --enter-animation: morph-contract;
  --transition-duration-normal: 500ms;
}

/* Elastic transitions for interactive elements */
[data-transition-context="elastic"] {
  --exit-animation: elastic-out;
  --enter-animation: elastic-in;
  --transition-duration-normal: 600ms;
  --transition-easing-standard: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* Flip transitions for card-based layouts */
[data-transition-context="flip"] {
  --exit-animation: flip-out-y;
  --enter-animation: flip-in-y;
  --transition-duration-normal: 400ms;
}

/* Slide-rotate for dynamic content */
[data-transition-context="slide-rotate"] {
  --exit-animation: slide-rotate-out;
  --enter-animation: slide-rotate-in;
}

/* Zoom-blur for focus transitions */
[data-transition-context="zoom-blur"] {
  --exit-animation: zoom-blur-out;
  --enter-animation: zoom-blur-in;
  --transition-duration-normal: 350ms;
}

/* Advanced element-specific transitions */

/* Hero section transitions */
::view-transition-old(hero-section),
::view-transition-new(hero-section) {
  animation-duration: calc(var(--transition-duration-normal) * 1.2);
  animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

::view-transition-old(hero-section) {
  animation-name: zoom-blur-out;
}

::view-transition-new(hero-section) {
  animation-name: zoom-blur-in;
}

/* Card grid transitions */
::view-transition-old(card-grid),
::view-transition-new(card-grid) {
  animation-duration: var(--transition-duration-slow);
  animation-timing-function: var(--transition-easing-decelerate);
}

::view-transition-old(card-grid) {
  animation-name: stagger-fade-out;
}

::view-transition-new(card-grid) {
  animation-name: stagger-fade-in;
}

/* Navigation menu transitions */
::view-transition-old(nav-menu),
::view-transition-new(nav-menu) {
  animation-duration: var(--transition-duration-fast);
  animation-timing-function: var(--transition-easing-accelerate);
}

::view-transition-old(nav-menu) {
  animation-name: slide-rotate-out;
}

::view-transition-new(nav-menu) {
  animation-name: slide-rotate-in;
}

/* Modal and overlay transitions */
::view-transition-old(modal-overlay),
::view-transition-new(modal-overlay) {
  animation-duration: var(--transition-duration-normal);
  animation-timing-function: ease-out;
}

::view-transition-old(modal-overlay) {
  animation-name: fade-out;
}

::view-transition-new(modal-overlay) {
  animation-name: fade-in;
}

/* Search results transitions */
::view-transition-old(search-results),
::view-transition-new(search-results) {
  animation-duration: var(--transition-duration-fast);
  animation-timing-function: var(--transition-easing-standard);
}

::view-transition-old(search-results) {
  animation-name: stagger-fade-out;
}

::view-transition-new(search-results) {
  animation-name: stagger-fade-in;
}

/* Performance optimizations for complex animations */

/* Ensure hardware acceleration for all advanced transitions */
[data-transition-context*="advanced"] ::view-transition-old(*),
[data-transition-context*="advanced"] ::view-transition-new(*) {
  will-change: transform, opacity, filter;
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
  contain: layout style paint;
}

/* Optimize for high refresh rate displays */
@media (min-resolution: 120dpi) {
  [data-transition-context*="advanced"] {
    --transition-duration-fast: calc(var(--transition-duration-fast) * 0.8);
    --transition-duration-normal: calc(var(--transition-duration-normal) * 0.8);
    --transition-duration-slow: calc(var(--transition-duration-slow) * 0.8);
  }
}

/* Reduce complexity on lower-end devices */
@media (max-width: 768px) and (max-device-pixel-ratio: 2) {
  [data-transition-context*="advanced"] {
    /* Fallback to simpler animations on lower-end mobile devices */
    --exit-animation: fade-out;
    --enter-animation: fade-in;
    --transition-duration-normal: var(--transition-duration-fast);
  }
}

/* Disable complex animations on very low-end devices */
@media (max-width: 480px) and (max-device-pixel-ratio: 1.5) {
  [data-transition-context*="advanced"] ::view-transition-old(*),
  [data-transition-context*="advanced"] ::view-transition-new(*) {
    animation: none !important;
  }
}

/* Battery-aware optimizations for complex animations */
[data-battery-low="true"] [data-transition-context*="advanced"] {
  /* Simplify animations when battery is low */
  --exit-animation: fade-out;
  --enter-animation: fade-in;
  --transition-duration-normal: var(--transition-duration-fast);
}

[data-battery-low="true"] [data-transition-context*="advanced"] ::view-transition-old(*),
[data-battery-low="true"] [data-transition-context*="advanced"] ::view-transition-new(*) {
  filter: none !important;
  transform: none !important;
  animation-duration: calc(var(--transition-duration-fast) * 0.5) !important;
}
/* 
Optimizer-driven performance optimizations */

/* Use optimized durations when available */
[data-hardware-acceleration="true"] ::view-transition-old(*),
[data-hardware-acceleration="true"] ::view-transition-new(*) {
  animation-duration: var(--transition-duration-optimized, var(--transition-duration-normal));
  animation-timing-function: var(--transition-easing-optimized, var(--transition-easing-standard));
}

/* Simplified animations for low-complexity mode */
[data-animation-complexity="low"] ::view-transition-old(main-content),
[data-animation-complexity="low"] ::view-transition-new(main-content) {
  animation: fade-out var(--transition-duration-optimized, 150ms) ease-out,
             fade-in var(--transition-duration-optimized, 150ms) ease-in !important;
}

/* Medium complexity optimizations */
[data-animation-complexity="medium"] [data-transition-context*="advanced"] {
  --exit-animation: slide-out-left;
  --enter-animation: slide-in-right;
}

/* Emergency mode - disable all complex animations */
[data-emergency-mode="true"] ::view-transition-old(*),
[data-emergency-mode="true"] ::view-transition-new(*) {
  animation: fade-out 100ms ease-out, fade-in 100ms ease-in !important;
  filter: none !important;
  transform: none !important;
}

/* Force simple transitions when needed */
[data-force-simple-transitions="true"] ::view-transition-old(*),
[data-force-simple-transitions="true"] ::view-transition-new(*) {
  animation: fade-out var(--transition-duration-optimized, 100ms) ease-out,
             fade-in var(--transition-duration-optimized, 100ms) ease-in !important;
}

/* GPU tier optimizations */
[data-gpu-tier="high"] ::view-transition-old(*),
[data-gpu-tier="high"] ::view-transition-new(*) {
  /* Enable all advanced features for high-end GPUs */
  will-change: transform, opacity, filter;
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

[data-gpu-tier="low"] ::view-transition-old(*),
[data-gpu-tier="low"] ::view-transition-new(*) {
  /* Disable hardware acceleration for low-end GPUs */
  will-change: auto;
  transform: none;
  backface-visibility: visible;
  perspective: none;
  filter: none !important;
}

/* CPU core optimizations */
[data-cpu-cores="1"], [data-cpu-cores="2"] {
  --transition-duration-optimized: 150ms;
  --transition-easing-optimized: ease-out;
}

[data-cpu-cores="1"] ::view-transition-old(*),
[data-cpu-cores="1"] ::view-transition-new(*),
[data-cpu-cores="2"] ::view-transition-old(*),
[data-cpu-cores="2"] ::view-transition-new(*) {
  animation-duration: var(--transition-duration-optimized) !important;
  animation-timing-function: var(--transition-easing-optimized) !important;
}

/* Memory usage optimizations */
[data-memory-usage="high"] ::view-transition-old(*),
[data-memory-usage="high"] ::view-transition-new(*) {
  /* Reduce memory usage by disabling complex properties */
  contain: none;
  will-change: auto;
  animation-duration: calc(var(--transition-duration-optimized, 200ms) * 0.7) !important;
}

/* Frame rate adaptive optimizations */
[data-current-fps="30"], [data-current-fps="31"], [data-current-fps="32"], [data-current-fps="33"], [data-current-fps="34"],
[data-current-fps="35"], [data-current-fps="36"], [data-current-fps="37"], [data-current-fps="38"], [data-current-fps="39"],
[data-current-fps="40"], [data-current-fps="41"], [data-current-fps="42"], [data-current-fps="43"], [data-current-fps="44"] {
  /* Low frame rate detected - simplify animations */
  --transition-duration-optimized: 150ms;
  --transition-easing-optimized: ease-out;
}

[data-current-fps="30"] ::view-transition-old(*),
[data-current-fps="30"] ::view-transition-new(*) {
  animation: fade-out 100ms ease-out, fade-in 100ms ease-in !important;
}

/* Connection-aware optimizations */
[data-connection-type="slow-2g"] ::view-transition-old(*),
[data-connection-type="slow-2g"] ::view-transition-new(*),
[data-connection-type="2g"] ::view-transition-old(*),
[data-connection-type="2g"] ::view-transition-new(*) {
  animation-duration: calc(var(--transition-duration-optimized, 150ms) * 0.8) !important;
  animation-timing-function: ease-out !important;
}

/* Save data mode optimizations */
[data-save-data="true"] ::view-transition-old(*),
[data-save-data="true"] ::view-transition-new(*) {
  animation-duration: calc(var(--transition-duration-optimized, 150ms) * 0.6) !important;
  filter: none !important;
  transform: translateX(0) !important; /* Disable complex transforms */
}