---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import ServiceWorkerUpdateManager from "../components/ServiceWorkerUpdateManager";
import PWAErrorBoundary from "../components/PWAErrorBoundary";
import ConditionalContent from "../components/ConditionalContent";
import { AccessibilityControls } from "../components/AccessibilityControls";

export interface Props {
    content: {
        title: string;
        description: string;
    };
}

const {
    content: { title, description },
} = Astro.props;
---

<html lang="en" transition:animate="fade">
    <head>
        <BaseHead title={title} description={description} />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap"
            rel="stylesheet"
        />
        <script src="../scripts/themeInitializer.ts"></script>
    </head>

    <body
        class="bg-background min-h-screen font-sans text-foreground leading-relaxed"
    >
        <!-- Skip Navigation Links -->
        <nav class="skip-links" aria-label="Skip navigation">
            <a href="#main-content" class="skip-link" style="view-transition-name: skip-link-main;">
                Skip to main content
            </a>
            <a href="#navigation" class="skip-link" style="view-transition-name: skip-link-nav;">
                Skip to navigation
            </a>
            <a href="#footer" class="skip-link" style="view-transition-name: skip-link-footer;">
                Skip to footer
            </a>
        </nav>

        <PWAErrorBoundary client:load>
            <div 
                class="mx-auto max-w-8xl p-4 sm:p-6 lg:p-8" 
                style="padding-top: calc(var(--sat) + 1rem);" 
                transition:name="page-container"
            >
                <Header transition:name="header" />
                <ConditionalContent client:load>
                    <main id="main-content" transition:name="main-content" transition:animate="slide">
                        <slot />
                    </main>
                    <Footer transition:name="footer" />
                </ConditionalContent>
            </div>
        </PWAErrorBoundary>

        <ServiceWorkerUpdateManager client:load />
        <AccessibilityControls client:load />
        
        <script src="../scripts/accessibilityInitializer.ts"></script>
        <script src="../scripts/navigationHandler.ts"></script>
        <script src="../scripts/transitionInitializer.ts"></script>
    </body>
</html>
