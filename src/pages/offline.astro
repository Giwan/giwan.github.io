---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE } from "../config";

const title = "You're Offline - " + SITE_TITLE;
const description = "You're currently offline. Here are some suggestions for cached content you can still access.";
---

<html lang="en">
    <head>
        <BaseHead title={title} description={description} />
        <!-- Inline critical styles to avoid external dependencies -->
        <style>
            .offline-icon {
                width: 64px;
                height: 64px;
                margin: 0 auto 1.5rem;
                opacity: 0.6;
            }
            
            .offline-container {
                text-align: center;
                max-width: 600px;
                margin: 0 auto;
                padding: 2rem 1rem;
            }
            
            .offline-title {
                font-size: 2rem;
                font-weight: 600;
                margin-bottom: 1rem;
                color: hsl(var(--foreground));
            }
            
            .offline-description {
                font-size: 1.125rem;
                margin-bottom: 2rem;
                color: hsl(var(--muted-foreground));
                line-height: 1.6;
            }
            
            .suggestions-list {
                text-align: left;
                margin: 2rem 0;
                padding: 1.5rem;
                background: hsl(var(--card));
                border: 1px solid hsl(var(--border));
                border-radius: 0.5rem;
            }
            
            .suggestions-title {
                font-size: 1.25rem;
                font-weight: 600;
                margin-bottom: 1rem;
                color: hsl(var(--foreground));
            }
            
            .suggestion-item {
                margin-bottom: 0.75rem;
                color: hsl(var(--muted-foreground));
            }
            
            .suggestion-item:last-child {
                margin-bottom: 0;
            }
            
            .retry-button {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                background: hsl(var(--primary));
                color: hsl(var(--primary-foreground));
                border: none;
                border-radius: 0.375rem;
                font-weight: 500;
                cursor: pointer;
                transition: background-color 0.2s;
                text-decoration: none;
            }
            
            .retry-button:hover {
                background: hsl(var(--primary) / 0.9);
            }
            
            .retry-button:focus {
                outline: none;
                box-shadow: 0 0 0 2px hsl(var(--ring));
            }
            
            .network-status {
                margin-top: 2rem;
                padding: 1rem;
                border-radius: 0.375rem;
                font-size: 0.875rem;
            }
            
            .network-status.offline {
                background: hsl(var(--destructive) / 0.1);
                color: hsl(var(--destructive-foreground));
                border: 1px solid hsl(var(--destructive) / 0.2);
            }
            
            .network-status.online {
                background: hsl(142 76% 36% / 0.1);
                color: hsl(142 76% 36%);
                border: 1px solid hsl(142 76% 36% / 0.2);
            }
        </style>
    </head>

    <body class="bg-background min-h-screen font-sans text-foreground leading-relaxed">
        <!-- Skip Navigation Link -->
        <a href="#main-content" class="skip-link">
            Skip to main content
        </a>
        
        <div class="mx-auto max-w-8xl p-4 sm:p-6 lg:p-8">
            <Header />
            <main id="main-content" role="main">
                <div class="offline-container">
                    <!-- Inline SVG icon to avoid external dependencies -->
                    <div class="offline-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12h18m-9-9v18"/>
                            <path d="m8 8 8 8"/>
                            <path d="m16 8-8 8"/>
                        </svg>
                    </div>
                    
                    <h1 class="offline-title">You're Currently Offline</h1>
                    
                    <p class="offline-description">
                        Don't worry! You can still access some content that's been cached on your device.
                    </p>
                    
                    <div class="suggestions-list">
                        <h2 class="suggestions-title">What you can do:</h2>
                        <ul>
                            <li class="suggestion-item">â€¢ Try navigating back to previously visited blog posts</li>
                            <li class="suggestion-item">â€¢ Check your browser's back button for cached pages</li>
                            <li class="suggestion-item">â€¢ Visit the homepage which may be cached</li>
                            <li class="suggestion-item">â€¢ Wait for your connection to return and try again</li>
                        </ul>
                    </div>
                    
                    <button class="retry-button" onclick="window.location.reload()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                            <path d="M3 21v-5h5"/>
                        </svg>
                        Try Again
                    </button>
                    
                    <div id="network-status" class="network-status offline">
                        ðŸ”´ You're currently offline
                    </div>
                </div>
            </main>
            <Footer />
        </div>
        
        <!-- Inline JavaScript to avoid external dependencies -->
        <script>
            // Network status detection
            function updateNetworkStatus() {
                const statusElement = document.getElementById('network-status');
                if (navigator.onLine) {
                    statusElement.textContent = 'ðŸŸ¢ Connection restored! You can try refreshing the page.';
                    statusElement.className = 'network-status online';
                } else {
                    statusElement.textContent = 'ðŸ”´ You\'re currently offline';
                    statusElement.className = 'network-status offline';
                }
            }
            
            // Listen for network status changes
            window.addEventListener('online', updateNetworkStatus);
            window.addEventListener('offline', updateNetworkStatus);
            
            // Initial status check
            updateNetworkStatus();
            
            // Theme handling (inline to avoid external dependencies)
            (function() {
                function getInitialTheme() {
                    const persistedTheme = localStorage.getItem('theme');
                    const hasPersistedTheme = typeof persistedTheme === 'string';
                    
                    if (hasPersistedTheme) {
                        if (persistedTheme === 'system') {
                            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                        }
                        return persistedTheme;
                    }
                    
                    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }

                const theme = getInitialTheme();
                const root = document.documentElement;
                
                if (theme === 'dark') {
                    root.classList.add('dark');
                    root.setAttribute('data-theme', 'dark');
                } else {
                    root.classList.remove('dark');
                    root.setAttribute('data-theme', 'light');
                }
            })();
        </script>
    </body>
</html>